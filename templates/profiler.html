{% spaceless %}
<script>
function changeTab(tab) {
  $('#pQp').removeClass('console speed queries memory files').addClass(tab);
}

function toggleDetails() {
  $('#pqp-container').toggleClass('hideDetails');
  $('#pqp-metrics').toggle();
  $('#profiler_short_data').toggle();
}

function hideProfiler() {
  $('#pqp-container').empty();
}
</script>

<link rel="stylesheet" type="text/css" href="//ivacuum.org/i/profiler/style.css">

<div id="pqp-container" class="pQp hideDetails tallDetails">
<div id="pQp" class="console">
	<table id="pqp-metrics" cellspacing="0" style="display: none;">
	<tr>
		<td class="green" onclick="changeTab('console');">
			<var>{{ LOGS_COUNT }}</var>
			<h4>{{ lang('CONSOLE') }}</h4>
		</td>
		<td class="blue" onclick="changeTab('speed');">
			<var>{{ SPEED_TOTAL }}</var>
			<h4>{{ lang('LOAD_TIME') }}</h4>
		</td>
		<td class="purple" onclick="changeTab('queries');">
			<var>{{ plural(QUERY_COUNT, 'QUERIES') }}</var>
			<h4>{{ lang('DATABASE') }}</h4>
		</td>
		<td class="orange" onclick="changeTab('memory');">
			<var>{{ MEMORY_USED }}</var>
			<h4>{{ lang('MEMORY_USED') }}</h4>
		</td>
		<td class="red" onclick="changeTab('files');">
			<var>{{ plural(FILE_COUNT, 'FILES') }}</var>
			<h4>{{ lang('INCLUDED') }}</h4>
		</td>
	</tr>
	</table>

	<div id="pqp-console" class="pqp-box">
		{% if LOGS_COUNT == 0 %}
			<h3>{{ lang('NO_DATA') }}</h3>
		{% else %}
			<table class="side" cellspacing="0">
				<tr>
					<td class="alt1"><var>{{ LOG_COUNT }}</var><h4>Logs</h4></td>
					<td class="alt2"><var>{{ ERROR_COUNT }}</var> <h4>Errors</h4></td>
				</tr>
				<tr>
					<td class="alt3"><var>{{ MEMORY_COUNT }}</var> <h4>Memory</h4></td>
					<td class="alt4"><var>{{ SPEED_COUNT }}</var> <h4>Speed</h4></td>
				</tr>
			</table>
			<div style="float: left; overflow: auto; width: 80%;">
			<table class="main" cellspacing="0">
			{% for row in profiler_logs %}
				<tr class="log-{{ row.type }}">
					<td class="type">{{ row.type }}</td>
					<td class="{{ cycle(['alt', ''], loop.index) }}">
					{% if row.type == 'log' %}
						<div><pre>{{ row.data }}</pre></div>
					{% elseif row.type == 'memory' %}
						<div><pre>{{ row.data }}</pre> <em>{{ row.data_type }}</em>: {{ row.name }} </div>
					{% elseif row.type == 'speed' %}
						<div><pre>{{ row.data }}</pre> <em>{{ row.name }}</em></div>
					{% elseif row.type == 'error' %}
						<div><em>Line {{ row.line }}</em> : {{ row.data }} <pre>{{ row.call_stack }}</pre></div>
					{% endif %}
					</td>
				</tr>
			{% endfor %}
			</table>
			</div>
		{% endif %}
	</div>

	<div id="pqp-speed" class="pqp-box">
		{% if SPEED_COUNT == 0 %}
			<h3>{{ lang('NO_DATA') }}</h3>
		{% else %}
			<table class="side" cellspacing="0">
				<tr><td><var>{{ SPEED_TOTAL }}</var><h4>Load Time</h4></td></tr>
				<tr><td class="alt"><var>{{ SPEED_ALLOWED }}</var> <h4>Max Execution Time</h4></td></tr>
			</table>
			<div style="float: left; overflow: auto; width: 80%;">
			<table class="main" cellspacing="0">
				{% for row in profiler_logs %}
					{% if row.type == 'speed' %}
						<tr class="log-{{ row.type }}"><td class="{{ cycle(['alt', ''], loop.index) }}"><div><pre>{{ row.data }}</pre> <em>{{ row.name }}</em></div></td></tr>
					{% endif %}
				{% endfor %}
			</table>
			</div>
		{% endif %}
	</div>

	<div id="pqp-queries" class="pqp-box">
		{% if QUERY_COUNT == 0 %}
			<h3>{{ lang('NO_DATA') }}</h3>
		{% else %}
			<table class="side" cellspacing="0">
				<tr><td><var>{{ QUERY_COUNT }}</var><h4>{{ lang('TOTAL_QUERIES') }}</h4></td></tr>
				<tr><td class="alt"><var>{{ QUERY_CACHED }}</var><h4>{{ lang('FROM_CACHE') }}</h4></td></tr>
				<tr><td><var>{{ QUERY_TIME }}</var> <h4>{{ lang('EXECUTION_TIME') }}</h4></td></tr>
			</table>
			<div style="float: left; overflow: auto; width: 80%;">
			<table class="main" cellspacing="0">
				{% for row in profiler_queries %}
					<tr><td class="{{ cycle(['alt', ''], loop.index) }}">{{ row.sql }} <em>{{ row.time }}{% if row.cached %} <span style="color: #ffd700;">({{ lang('FROM_CACHE')|lower }})</span>{% endif %}</em></td></tr>
				{% endfor %}
			</table>
			</div>
		{% endif %}
	</div>

	<div id="pqp-memory" class="pqp-box">
		{% if MEMORY_COUNT == 0 %}
			<h3>{{ lang('NO_DATA') }}</h3>
		{% else %}
			<table class="side" cellspacing="0">
				<tr><td><var>{{ MEMORY_USED }}</var><h4>Used Memory</h4></td></tr>
				<tr><td class="alt"><var>{{ MEMORY_TOTAL }}</var> <h4>Total Available</h4></td></tr>
			</table>
			<div style="float: left; overflow: auto; width: 80%;">
			<table class="main" cellspacing="0">
				{% for row in profiler_logs %}
					{% if row.type == 'memory' %}
						<tr class="log-{{ row.type }}"><td class="{{ cycle(['alt', ''], loop.index) }}"><b>{{ humn_size(row.data, 2) }}</b> <em>{{ row.data_type }}</em>: {{ row.name }}</td></tr>
					{% endif %}
				{% endfor %}
			</table>
			</div>
		{% endif %}
	</div>

	<div id="pqp-files" class="pqp-box">
		{% if FILE_COUNT == 0 %}
			<h3>{{ lang('NO_DATA') }}</h3>
		{% else %}
			<table class="side" cellspacing="0">
				<tr><td><var>{{ FILE_COUNT }}</var><h4>{{ lang('TOTAL_FILES') }}</h4></td></tr>
				<tr><td class="alt"><var>{{ humn_size(FILE_SIZE) }}</var><h4>{{ lang('TOTAL_SIZE') }}</h4></td></tr>
				<tr><td><var>{{ humn_size(FILE_LARGEST) }}</var><h4>{{ lang('LARGEST') }}</h4></td></tr>
			</table>
			<div style="float: left; overflow: auto; width: 80%;">
			<table class="main" cellspacing="0">
				{% for row in profiler_files %}
					<tr><td class="{{ cycle(['alt', ''], loop.index) }}"><b>{{ humn_size(row.size, 2) }}</b> {{ row.name }}</td></tr>
				{% endfor %}
			</table>
			</div>
		{% endif %}
	</div>

	<table id="pqp-footer" cellspacing="0">
		<tr>
			<td id="profiler_short_data_container">
				<ul id="profiler_short_data">
					<li><img src="//ivacuum.org/i/_/application_monitor.png" title="{{ lang('CONSOLE') }}"> <span class="green">{{ LOGS_COUNT }}</span></li>
					<li><img src="//ivacuum.org/i/_/dashboard.png" title="{{ lang('LOAD_TIME') }}"> <span class="blue">{{ SPEED_TOTAL }}</span></li>
					<li><img src="//ivacuum.org/i/_/database.png" title="{{ lang('DATABASE') }}"> <span class="purple">{{ plural(QUERY_COUNT, 'QUERIES') }}</span></li>
					<li><img src="//ivacuum.org/i/_/memory.png" title="{{ lang('MEMORY_USED') }}"> <span class="orange">{{ humn_size(MEMORY_USED) }}</span></li>
					<li><img src="//ivacuum.org/i/_/document_php.png" title="{{ lang('INCLUDED') }}"> <span class="red">{{ plural(FILE_COUNT, 'FILES') }}</span></li>
					<li><img src="//ivacuum.org/i/_/server_network.png"> <span class="green">{{ SERVER_HOSTNAME }}</span></li>
				</ul>
			</td>
			<td class="actions">
				<a onclick="hideProfiler(); return false;">&times;</a>
				<a onclick="toggleDetails(); return false">{{ lang('DETAILS') }}</a>
			</td>
		</tr>
	</table>
</div>
</div>
{% endspaceless %}